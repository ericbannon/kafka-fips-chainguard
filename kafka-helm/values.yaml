# If your cluster needs pull secrets:
# global:
#   imagePullSecrets:
#     - your-regcred

clusterDomain: cluster.local
usePasswordFiles: true

# --- Image (optional override; defaults already point at Chainguard private repo) ---
image:
  registry: 452336408843.dkr.ecr.us-west-2.amazonaws.com
  repository: kafka
  tag: iamguarded-cg
  pullPolicy: Always
# --- KRaft layout ---
# 3 controllers (IDs start at controller.minId=0)
# 3 brokers (IDs start at broker.minId=100)
controller:
  controllerOnly: true
  replicaCount: 3
  minId: 0
  persistence:
    enabled: true
    storageClass: gp2-csi
    size: 5Gi

broker:
  replicaCount: 3
  minId: 100
  persistence:
    enabled: true
    storageClass: gp2-csi
    size: 5Gi

# --- Listeners (SSL everywhere; no SASL) ---
listeners:
  client:
    protocol: SSL
  interbroker:
    protocol: SSL
  controller:
    protocol: SSL
  external:
    protocol: SSL

# --- TLS (JKS from existing secrets) ---
tls:
  type: JKS
  autoGenerated:
    enabled: false
  existingSecret: kafka-jks
  passwordsSecret: kafka-tls-passwords
  passwordsSecretKeystoreKey: keystore-password
  passwordsSecretTruststoreKey: truststore-password

service:
  type: ClusterIP
  ports:
    client: 9092
    controller: 9093
    interbroker: 9094
    external: 9095
  extraPorts: []
  sessionAffinity: None
  sessionAffinityConfig: {}
  annotations: {}

  headless:
    controller:
      annotations: {}
      labels: {}
    broker:
      annotations: {}
      labels: {}
    ipFamilies: []
    ipFamilyPolicy: ""

# --- SASL off (since listeners are SSL, not SASL_SSL / SASL_PLAINTEXT) ---
sasl:
  existingSecret: ""

# If you want these topic settings, prefer overrideConfiguration/config style,
# but keeping extra config is fine if chart supports it via config/overrideConfiguration.
# If you previously used "extraConfig" on Bitnami, translate to this:
overrideConfiguration:
  controller.quorum.bootstrap.servers: >-
    kafka-controller-0.kafka-controller-headless.kafka.svc.cluster.local:9093,
    kafka-controller-1.kafka-controller-headless.kafka.svc.cluster.local:9093,
    kafka-controller-2.kafka-controller-headless.kafka.svc.cluster.local:9093
  ssl.endpoint.identification.algorithm: https
  offsets.topic.replication.factor: 3
  transaction.state.log.replication.factor: 3
  transaction.state.log.min.isr: 2
  min.insync.replicas: 2